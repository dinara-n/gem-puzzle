(()=>{"use strict";var t={};t.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),(()=>{var e;t.g.importScripts&&(e=t.g.location+"");var o=t.g.document;if(!e&&o&&(o.currentScript&&(e=o.currentScript.src),!e)){var r=o.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),t.p=e})();class e{constructor(t,o,r){this.gameBoard=t,this.rowLength=o,this.boardLength=this.rowLength**2,this.boardSize=this.getBoardSize(),this.gapSize=r,this.tileSize=this.getTileSize(),this.aimArray=[];for(let t=0;t<this.boardLength;t+=1)t!==this.boardLength-1?this.aimArray.push(t+1):this.aimArray.push(0);do{this.array=e.getShuffledArray(this.aimArray)}while(!e.isSolvable(this.array));this.tilesCoords=this.getTilesCoords(),this.movesNumber=0}static getShuffledArray(t){const e=Array.from(t);for(let t=e.length-1;t>0;t-=1){const o=Math.floor(Math.random()*(t+1));[e[t],e[o]]=[e[o],e[t]]}return e}static isSolvable(t){const e=Math.sqrt(t.length);let o=0;for(let e=0;e<t.length-1;e+=1)for(let r=e+1;r<t.length;r+=1)0!==t[e]&&0!==t[r]&&t[e]>t[r]&&(o+=1);return e%2?o%2==0:(o+=Math.trunc(t.indexOf(0)/e),o%2!=0)}getBoardSize(){return parseInt(window.getComputedStyle(this.gameBoard).getPropertyValue("width"),10)}getTileSize(){return Math.floor((this.boardSize-this.gapSize*(this.rowLength+1))/this.rowLength)}getTilesCoords(){const t=[];return this.array.forEach(((e,o)=>{const r=o%this.rowLength,n=this.gapSize+r*(this.tileSize+this.gapSize),s=n+this.tileSize,i=Math.trunc(o/this.rowLength),a=this.gapSize+i*(this.tileSize+this.gapSize),l=a+this.tileSize;t.push({xStart:n,xEnd:s,yStart:a,yEnd:l})})),t}swapTiles(t){const e=[t-1,t+1,t-this.rowLength,t+this.rowLength];void 0!==this.array[t]&&e.forEach((e=>{const o=Math.trunc(t/this.rowLength)===Math.trunc(e/this.rowLength),r=t%this.rowLength==e%this.rowLength;(o||r)&&void 0!==this.array[e]&&0===this.array[e]&&([this.array[t],this.array[e]]=[this.array[e],this.array[t]],this.movesNumber+=1)}))}recalculateStats(){this.boardSize=this.getBoardSize(),this.tileSize=this.getTileSize(),this.tilesCoords=this.getTilesCoords()}isSolved(){for(let t=0;t<this.boardLength;t+=1)if(this.array[t]!==this.aimArray[t])return!1;return!0}}const o=e;t.p,t.p,document.addEventListener("DOMContentLoaded",(()=>{function t(t,e="",o=document.body,r=""){const n=document.createElement(t);return n.textContent=e,n.classList.add(r),o.append(n),n}const e=t("main",null,document.body,"main-container"),r=t("section",null,e,"game-controls");t("label","Size:",r,"game-controls__size-label").htmlFor="board-size";const n=t("select",null,r,"game-controls__size");n.name="board-size";for(let e=3;e<=8;e+=1)t("option",`${e} x ${e}`,n,"game-controls__size-select").value=e;n.value=4;const s=t("button","New Game",r,"game-controls__btn");s.classList.add("game-controls__btn--new"),t("button","Save",r,"game-controls__btn"),s.classList.add("game-controls__btn--save"),t("button","Saved Game",r,"game-controls__btn"),s.classList.add("game-controls__btn--saved"),t("button","Sound on",r,"game-controls__btn"),s.classList.add("game-controls__btn--sound"),t("button","Winners",r,"game-controls__btn"),s.classList.add("game-controls__btn--winners");const i=t("section",null,e,"game-info"),a=t("p","",i,"game-info__time"),l=t("span","0:0",a,"game-info__timer"),h=t("p","Moves: ",i,"game-info__moves"),c=t("span","0",h,"game-info__moves-number"),u=t("section",null,e,"gameboard-wrapper"),d=t("canvas","Sorry! It seems your browser does not support HTML Canvas. Please try another browser.",u,"gameboard");d.width=300,d.height=300;let g=Math.trunc(Date.now()/1e3);function m(){const t=Math.trunc(Date.now()/1e3)-g;let e=Math.trunc(t/60);e=e>9?e:`0${e}`;let o=t%60;o=o>9?o:`0${o}`,l.textContent=`${e} : ${o}`}setInterval(m,100);let v=new o(d,+n.value,5);console.log(v);const b=[];function f(){if(d.getContext){const t=d.getContext("2d");t.clearRect(0,0,d.width,d.height),b.length=0,v.array.forEach(((e,o)=>{if(e){const r=new Path2D;t.beginPath(),function(t,e,o,r,n,s,i){t.moveTo(e,r+5),t.quadraticCurveTo(e,r,e+5,r),t.lineTo(o-5,r),t.quadraticCurveTo(o,r,o,r+5),t.lineTo(o,n-5),t.quadraticCurveTo(o,n,o-5,n),t.lineTo(e+5,n),t.quadraticCurveTo(e,n,e,n-5)}(r,v.tilesCoords[o].xStart,v.tilesCoords[o].xEnd,v.tilesCoords[o].yStart,v.tilesCoords[o].yEnd),t.fillStyle="orange",t.fill(r),t.fillStyle="beige",t.font="2em Arial",t.fillText(e,v.tilesCoords[o].xStart+20,v.tilesCoords[o].yStart+40),b.push(r)}else b.push(null)}))}}function p(t){t.preventDefault(),d.removeEventListener("mouseup",S),d.removeEventListener("mousemove",p),console.log("mousemove")}function S(t){d.removeEventListener("mousemove",p),d.removeEventListener("mouseup",S),console.log("click");const e=d.getBoundingClientRect(),o=t.clientX-e.left,r=t.clientY-e.top;for(let t=0;t<v.boardLength;t+=1){const e=v.tilesCoords[t];if(o>=e.xStart&&o<=e.xEnd&&r>=e.yStart&&r<=e.yEnd){v.swapTiles(t),f(),c.textContent=v.movesNumber;break}}v.isSolved()&&console.log("Solved!")}f(),n.addEventListener("change",(()=>{v=new o(d,+n.value,5),f(),v.movesNumber=0,c.textContent=v.movesNumber,console.log(v),clearInterval(m),g=Math.trunc(Date.now()/1e3),setInterval(m,100)})),s.addEventListener("click",(()=>{v=new o(d,+n.value,5),f(),v.movesNumber=0,c.textContent=v.movesNumber,clearInterval(m),g=Math.trunc(Date.now()/1e3),setInterval(m,100)})),d.addEventListener("mousedown",(function(){d.addEventListener("mousemove",p),d.addEventListener("mouseup",S)}))}))})();